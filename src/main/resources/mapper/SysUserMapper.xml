<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sundata.edu.dao.ISysUserDao">
    <insert id="insert" parameterType="Person">
        insert into t_sys_user (id, `name`, id_card, `state`, role_id, create_date) values
        (#{id}, #{name}, #{idCard}, #{state}, #{roleId}, #{createDate})
    </insert>

    <delete id="delete" parameterType="java.io.Serializable">
        delete from t_sys_user where id = #{id}
    </delete>

    <update id="update" parameterType="Person">
        update t_sys_user
        <trim prefix="set" prefixOverrides=",">
            <if test="name != null">
                , `name` = #{name}
            </if>
            <if test="state != null">
                , `state` = #{state}
            </if>
            <if test="idCard != null">
                , id_card = #{idCard}
            </if>
            <if test="roleId != null">
                , role_id = #{roleId}
            </if>
        </trim>
        where id = #{id}
    </update>

    <!-- 批量删除 -->
    <delete id="batchDelete" parameterType="java.util.List">
        delete from t_sys_user where
        <foreach collection="list" index="index" item="item" separator="or">
            id = #{item}
        </foreach>
    </delete>

    <delete id="deleteByIdCard" parameterType="java.io.Serializable">
        delete from t_sys_user where id_card = #{idCard}
    </delete>

    <!-- 批量删除 -->
    <delete id="batchDeleteByIdCard" parameterType="java.util.List">
        delete from t_sys_user where
        <foreach collection="list" index="index" item="item" separator="or">
            id_card = #{item}
        </foreach>
    </delete>

    <select id="selectById" parameterType="java.io.Serializable" resultType="Person">
        select * from t_sys_user where id = #{id}
    </select>

    <select id="selectByIdCard" parameterType="java.io.Serializable" resultType="Person">
        select * from t_sys_user where id_card = #{idCard}
    </select>

    <select id="selectWithPage" parameterType="map"  resultType="Person">
        select *
        from t_sys_user
        <trim prefix="where" prefixOverrides="AND | OR">
            <if test="idCard != null">
                and id_card = #{idCard}
            </if>
            <choose>
                <when test="state != null">
                    and `state` = #{state}
                </when>
                <otherwise>
                    and `state` != -1
                </otherwise>
            </choose>
            <if test="name != null">
                and `name` like CONCAT('%',#{name},'%')
            </if>
        </trim>
        order by create_date desc
        <if test="offset != null and limit !=null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countWithCondition" parameterType="map" resultType="long">
        select count(0) from t_sys_user
        <trim prefix="where" prefixOverrides="AND | OR">
            <if test="idCard != null">
                and id_card = #{idCard}
            </if>
            <choose>
                <when test="state != null">
                    and `state` = #{state}
                </when>
                <otherwise>
                    and `state` != -1
                </otherwise>
            </choose>
            <if test="name != null">
                and `name` like CONCAT('%',#{name},'%')
            </if>
        </trim>
    </select>
</mapper>
